---
title: "Stat 5309 Lab 6"
author: "Tom Wilson"
date: "Mar 26, 2019"
output: pdf_document
---

```{r setup, include=FALSE, message=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(dplyr)
library(knitr)
library(agricolae)
library(rsm)
library(ggplot2)
```

# 1

```{r}
bit_sizes <- c("1/16","1/8")
speeds <- c("40","90")
treatments <- expand.grid(bit_size=rep(bit_sizes,4),speed=speeds)
treatments
circuit_data <- data.frame(treatments,
                           vibration =c(18.2,27.2,
                                        18.9,24.0,
                                        12.9,22.4,
                                        14.4,22.5,
                                        15.9,41.0,
                                        14.5,43.9,
                                        15.1,36.3,
                                        14.2,39.9
                                        )
                           )
circuit_data %>% kable()
```

## a
analyze the data from this experiment.

```{r}
vibration_model <- aov(formula = vibration~bit_size*speed, data=circuit_data)
summary(vibration_model)
```

## b
construct a normal probability plot of the residuals, and plot the residuals versus the predicted vibration level. Interpret these plots.

```{r}
par( mfrow = c(2,2) )
plot(vibration_model)
```

## c
Draw the AB interaction plot. What levels of bit size and speed would you recommend for routine operation?
```{r}
interaction.plot(x.factor = circuit_data$bit_size,
                 trace.factor = circuit_data$speed,
                 response = circuit_data$vibration)
```

# 2

```{r}
cutting_speeds <- c("-","+")
tool_geometries <- c("-","+")
cutting_angles <- c("-","+")
machine_trts <- expand.grid(cutting_speed=rep(cutting_speeds,3),
                            tool_geometry=tool_geometries,
                            cutting_angle=cutting_angles)
machine_trts
machine_data <- data.frame(machine_trts,
                           lifetime = c(22,32,
                                        31,42,
                                        25,29,
                                        35,55,
                                        34,47,
                                        50,46,
                                        44,40,
                                        45,37,
                                        38,36,
                                        60,39,
                                        50,41,
                                        54,47
                                        )
                           )
machine_data %>% kable()
```

## a
Estimate the factor effects. Which effect appears to be large?

```{r}
lifetime_model <- aov(lifetime~cutting_speed*tool_geometry*cutting_angle,data=machine_data)
lifetime_model$coefficients
```

## b
Use the analysis of variance to confirm your conclusions for part a.
```{r}
anova(lifetime_model)
```


## c
Write down a regression model for predicting tool life (in hours) based on the results of this experiment.

```{r}
reduced_lifetime_model <- lm(lifetime~tool_geometry*cutting_angle+cutting_speed:cutting_angle,data=machine_data)
summary(reduced_lifetime_model)
```

## d
Analyze the residuals. Are there any obvious problems?
```{r}
par( mfrow = c(2,2) )
plot(reduced_lifetime_model)
```

## e
based on an analysis of main effect and interaction plots, what levels of A, B, and C would you recommend using?

```{r}

```

# 3
An experiment was performed to improve the yield of a chemical process. Four factors were selectd, and two replicates of a completely randomized experiment were run. The results are shown in the following table.

## a
Estimate the factor effects.

## b
Prepare an analysis of variance table and determine which factors are important in explaining yield.

## c
Write down a regression model for predicting yield, assuming that all four factors were varied over the range from -1 to +1.

## d
Plot the residuals versus the predicted yield and on a normal probability scale. Does the residual analysis appear satisfactory?

## e

Two three-factor interactions, ABC and ABD, apparently have large effects. Draw a cube plot in th factors A, B, and C with the average yields shown at each corner.
Repeat using the factors A, B, and D. Do these two plots aid in a data interpretation?
Where would you recommend that the process be run with respect to the four variables?

